<h4>Lista de Alunos</h4>

<button onclick="addAluno()" id="btn-form" class="btn waves-effect waves-light" type="submit" name="action">Inserir novo
    <i class="material-icons right">add</i>
</button>

<div hidden id="formCrud" class="row">
    <form class="col s12">
        <div class="row">
            <div class="input-field col s12">
                <input placeholder="Nome" id="nome" type="text" class="validate">
                <label class="active" for="nome">Nome</label>
            </div>
            <div class="input-field col s12">
                <input placeholder="Idade" id="idade" type="text" class="validate">
                <label class="active" for="idade">Idade</label>
            </div>
            <div class="input-field col s12">
                <input placeholder="Curso" id="curso" type="text" class="validate">
                <label class="active" for="curso">Curso</label>
            </div>
        </div>
    </form>
    <button id="enviarForm" class="btn waves-effect waves-light" type="submit" name="action">Salvar
        <i class="material-icons right">send</i>
    </button>
    <button onclick="cancelar()" class="btn waves-effect waves-light" type="submit" name="action">Cancelar
        <i class="material-icons right">clear</i>
    </button>
</div>

<ul id="pessoas" class="collection">

</ul>

<script>

    function listarDados(){
        $.getJSON('https://server-osito-json.herokuapp.com/posts', function (data, status) {
        let pessoas = []

        for (let pessoa of data) {
            pessoas.push(`
            <li class="collection-item avatar">
            <img src="../assets/images/perfil.jpeg" alt="" class="circle">
            <span class="title">${pessoa.aluno}</span>
            <p>${pessoa.idade || 'Não tem'} <br>
             ${pessoa.curso || 'Não tem'}
            </p>
            <button onclick="getPessoas(${pessoa.id})" class="btn waves-effect waves-light secondary-content" type="submit" name="action">Editar
            <i class="material-icons right">create</i>
            </button>
            </li>
            `)
        }

        $('#pessoas').html(pessoas)

    })
    }

    listarDados()

    function getPessoas(id) {
        $.getJSON(`https://server-osito-json.herokuapp.com/posts/${id}`, function (data, status) {
            $("#nome").val(data.aluno)
            $("#idade").val(data.idade)
            $("#curso").val(data.curso)
        })

        addAluno()
    }

    $("#enviarForm").click(function () {
        $.post("https://server-osito-json.herokuapp.com/posts",
            {
                "aluno": $("#nome").val(),
                "idade": $("#idade").val(),
                "curso": $("#curso").val(),
                "matricula": $("#matricula").val()
            });
    });

    function addAluno() {
        $("#formCrud").show()
        $("#pessoas").hide()
        $("#btn-form").hide()
    }

    function cancelar() {
        $("#formCrud").hide()
        $("#pessoas").show()
        $("#btn-form").show()
    }
</script>